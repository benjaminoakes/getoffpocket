<!-- Consent Banner -->
<div id="consent-banner" class="notification is-info is-light" style="display: none; position: fixed; bottom: 0; width: 100%; z-index: 100; margin: 0; border-radius: 0;">
  <div class="container">
    <div class="columns is-vcentered">
      <div class="column">
        <p>We use analytics to improve our services. This data is anonymous and helps us understand how visitors use our site.</p>
      </div>
      <div class="column is-narrow">
        <button class="button is-small is-link" onclick="acceptConsent()">Accept</button>
        <button class="button is-small" onclick="rejectConsent()">Reject</button>
      </div>
    </div>
  </div>
</div>

<!-- Google Analytics Consent Mode -->
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}

  // Default consent settings - respect privacy
  gtag('consent', 'default', {
    'analytics_storage': 'denied',
    'ad_storage': 'denied',
    'wait_for_update': 500
  });

  // Function to update consent
  function updateConsent(consent) {
    gtag('consent', 'update', consent);
  }

  // Check for saved consent
  if (localStorage.getItem('analytics_consent') === 'granted') {
    updateConsent({
      'analytics_storage': 'granted'
    });
  }
</script>
<script>
  // Show banner if consent not already set
  document.addEventListener('DOMContentLoaded', function() {
    if (!localStorage.getItem('analytics_consent')) {
      document.getElementById('consent-banner').style.display = 'block';
    }
  });

  function acceptConsent() {
    localStorage.setItem('analytics_consent', 'granted');
    updateConsent({
      'analytics_storage': 'granted'
    });
    document.getElementById('consent-banner').style.display = 'none';
    gtag('event', 'consent_update', {
      'status': 'accepted'
    });
  }

  function rejectConsent() {
    localStorage.setItem('analytics_consent', 'denied');
    document.getElementById('consent-banner').style.display = 'none';
    gtag('event', 'consent_update', {
      'status': 'rejected'
    });
  }
</script>
